<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Leaflit -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <!-- Leaflet Routing Machine  CSS-->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css"
    />

    <style>
      body {
        margin: 0;
        padding: 0;
      }
    </style>
    <title>Document</title>
  </head>
  <body>
    <div id="map" style="width: 100%; height: 100vh"></div>
  </body>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

  <script>
    // Polyline mapping
    const map = L.map("map").setView(
      [14.57031533402106, 120.99156564740088],
      17
    );
    const attribution = "";

    L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "Â© OpenStreetMap",
    }).addTo(map);

    // var marker = L.marker([14.57031533402106, 120.99156564740088]).addTo(map);
    // var latlngs = [
    //   [14.563586035304027, 120.99475618985656],
    //   [14.57031533402106, 120.99156564740088],
    //   [14.576564715923581, 120.98806937928339],
    //   [14.582535058815736, 120.98462986820749],
    // ];

    let allCoords = [];
    var marker = L.marker([14.582535058815736, 120.98462986820749]).addTo(map);

    map.on("click", (e) => {
      console.log(e.latlng.lat);
      console.log(e.latlng.lng);
      var secondMarker = L.marker([e.latlng.lat, e.latlng.lng]).addTo(map);

      L.Routing.control({
        waypoints: [
          L.latLng(14.563586035304027, 120.99475618985656),
          L.latLng(e.latlng.lat, e.latlng.lng),
        ],
        lineOptions: {
          styles: [
            { color: "orange", opacity: 1, weight: 8 }, // Adjust the weight property for thickness
          ],
        },
      })
        .on("routesfound", (e) => {
          console.log(e);
          e.routes[0].coordinates.forEach((coord, index) => {
            setTimeout(() => {
              marker.setLatLng([coord.lat, coord.lng]);
            }, 100 * index);
          });
        })
        .addTo(map);
      console.log(allCoords);
    });
    function createButton(label, container) {
      var btn = L.DomUtil.create("button", "", container);
      btn.setAttribute("type", "button");
      btn.innerHTML = label;
      return btn;
    }
  </script>

  <script src="./Control.Geocoder.js"></script>
</html>
